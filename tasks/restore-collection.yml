---
- name: List existing collections
  uri:
    url: '{{ sc_restore_base_url }}/admin/collections?'
    body: 'action=LIST'
    method: POST
  register: collections_list

- name: Get list of restore collections that already exists
  set_fact:
    existing_collections: '{{ pre_existing_collections | intersect (collection_names) }}'
    test123: '{{ collection_names }}'
    test345: '{{ pre_existing_collections }}'
  vars:
    pre_existing_collections:  '{{ collections_list | json_query(query) }}'
    collection_names: '{{ sc_restore_list | json_query(query2) }}'
    query: 'json.collections[]'
    query2: '[].collection_name'

- debug:
    var: existing_collections